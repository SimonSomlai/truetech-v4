<% content_for :title, "Articles"  %>
<% content_for :description, "This is the meta description for the article-admin menu" %>
<% content_for :css do %>
<link href="https://maxcdn.bootstrapcdn.com/font-awesome/4.6.3/css/font-awesome.min.css" rel="stylesheet" integrity="sha384-T8Gy5hrqNKT+hzMclPo118YTQO6cYprQmhrYwIiQ/3axmI1hQomh7Ud2hPOy8SP1" crossorigin="anonymous">
<%= stylesheet_link_tag "admin", "magnific-popup", "font-icons", "trumbowyg.min", "style"  %>
<% end %>

<body class="nav-md">
    <div class="container body admin-body">
        <div class="main_container admin-body">
            <%= render "shared/admin_menu" %>
            <div class="right_col cf" role="main">
                <div class="col-md-12 col-sm-12 col-xs-12 table-fade <%= table_hidden? %>">
                    <div class="x_panel">
                        <div class="x_title">
                            <h2>
                                <i class="fa fa-pencil"></i>
                                Articles |
                                <a onclick="createForm()" class="btn btn-sm btn-round btn-success">
                                    <i class="fa fa-plus"></i>
                                    <%= @action %>
                                    Article</a>
                            </h2>
                            <div class="clearfix"></div>
                        </div>
                        <div class="x_content">
                            <table class="table table-hover table-striped">
                                <thead>
                                    <tr>
                                        <th class="hidden-xs">#</th>
                                        <th>Title</th>
                                        <th class="hidden-xs">Description</th>
                                        <th class="hidden-xs">Category</th>
                                        <th class="hidden-xs">Image</th>
                                        <th class="hidden-xs">Author</th>
                                        <th class="hidden-xs">Status</th>
                                        <th>Options</th>
                                    </tr>
                                </thead>
                                <tbody>
                                    <% @articles.each do |article| %>
                                    <tr>
                                        <td scope="row" class="hidden-xs"><%= article.id %></td>
                                        <td>
                                          <!-- Link to en locale when technical article  -->
                                        <% if article.category.downcase == "coding" %>
                                            <%= link_to articles_show_path(article.slug_en, article: article.slug_en, locale: :en)  do %>
                                            <i class="fa fa-cogs"></i>
                                            <%= article.en_title %>
                                            <% end %>
                                        <% else %>
                                            <a target="_blank" href="<%= articles_show_path(article) %>">
                                              <i class="fa fa-search"></i>
                                                <%= article.title %>
                                            </a>
                                        <% end %>
                                        </td>
                                        <td class="hidden-xs"><%= article.description != "" ? article.description : article.en_description %></td>
                                        <td class="hidden-xs"><%= article.category %></td>
                                        <td class="hidden-xs">
                                            <% if !article.image.url.nil? %>
                                            <span data-lightbox="gallery">
                                                <a data-lightbox="gallery-item" href="<%= article.image.url %>">
                                                    <i class="fa fa-picture-o" aria-hidden="true"></i>
                                                </a>
                                            </span>
                                            <% end %>
                                        </td>
                                        <td class="hidden-xs"><%= author(article) %></td>
                                        <td class="hidden-xs">
                                            <% if article.posted? %>
                                            <%= "Posted" %>
                                        <% else %>
                                            <%= "Draft" %>
                                            <% end %>
                                        </td>
                                        <td>
                                            <%= link_to(edit_article_path(article), :class => "edit-link") do %>
                                            <i class="fa fa-pencil"></i>
                                            edit
                                            <% end %>
                                            |
                                            <%= link_to article_path(article), :method => "delete", :data => {:confirm => 'Are you sure?'} do %>
                                            <i class="fa fa-trash"></i>
                                            delete
                                            <% end %>
                                        </td>
                                    </tr>
                                    <% end %>
                                </tbody>
                            </table>
                        </div>
                    </div>
                </div>
                <div id="create-form" class="col-md-12 col-sm-12 col-xs-12 margin-top create-form <%= form_hidden? %>">
                    <div class="x_panel">
                        <div class="x_title">
                            <h2>
                                <i class="fa fa-pencil"></i>
                                <%= @action %>
                                Article
                                <span class="<%= form_hidden? %>">|</span>
                                <%= link_to("All Articles", articles_path, class: "open-form btn btn-sm btn-round btn-success #{form_hidden?}", :data => {:confirm => 'Your changes will not be saved - proceed?'}) %></h2>
                            <ul class="nav navbar-right panel_toolbox">
                                <li>
                                    <%= link_to "#", :class => "change-locale" do %>
                                    <div class="locale locale-menu <%= I18n.locale %>"></div>
                                    <% end %>
                                </li>
                            </ul>
                            <ul class="nav navbar-right panel_toolbox <%= table_hidden? %>">
                                <li>
                                    <a onclick="closeForm();" class="close-link">
                                        <i class="fa fa-close"></i>
                                    </a>
                                </li>
                            </ul>
                            <div class="clearfix"></div>
                        </div>
                        <div class="x_content">
                            <br>
                            <%= form_for(@article, :html => {:class => "form-horizontal form-label-left", :id => "demo-form2", :multipart => true }) do |f| %>
                            <%= render "shared/error_messages", object: f.object %>
                            <div class="form-group locale-field">
                                <%= f.label :title, "Title", class: "control-label col-md-3 col-sm-3 col-xs-12" %>
                                <div class="col-md-6 col-sm-6 col-xs-12">
                                    <%= f.text_field :title, :class => "form-control col-md-7 col-xs-12" %>
                                </div>
                            </div>
                            <div class="form-group locale-field col-hidden">
                                <%= f.label :en_title, "English Title", class: "control-label col-md-3 col-sm-3 col-xs-12" %>
                                <div class="col-md-6 col-sm-6 col-xs-12">
                                    <%= f.text_field :en_title, :class => "form-control col-md-7 col-xs-12" %>
                                </div>
                            </div>
                            <div class="form-group locale-field">
                                <%= f.label :description, "Description", class: "control-label col-md-3 col-sm-3 col-xs-12" %>
                                <div class="col-md-6 col-sm-6 col-xs-12">
                                    <%= f.text_area :description, :class => "form-control col-md-7 col-xs-12" %>
                                </div>
                            </div>
                            <div class="form-group locale-field col-hidden">
                                <%= f.label :en_description, "English Description", class: "control-label col-md-3 col-sm-3 col-xs-12" %>
                                <div class="col-md-6 col-sm-6 col-xs-12">
                                    <%= f.text_area :en_description, :class => "form-control col-md-7 col-xs-12" %>
                                </div>
                            </div>
                            <div class="form-group locale-field locale-nl">
                                <div class="col-md-12 col-sm-12 col-xs-12">
                                    <textarea id="editor"></textarea>
                                </div>
                            </div>
                            <div class="form-group form-nl">
                                <%= f.hidden_field :body, html: {:class => "form-control col-md-7 col-xs-12", :id => "editorcontent"} %>
                            </div>
                            <div class="form-group locale-field locale-en col-hidden">
                                <div class="col-md-12 col-sm-12 col-xs-12">
                                    <textarea id="editor2"></textarea>
                                </div>
                            </div>
                            <div class="form-group form-en">
                                <%= f.hidden_field :en_body, html: {:class => "form-control col-md-7 col-xs-12", :id => "editorcontent2"} %>
                            </div>
                            <div class="form-group">
                                <%= f.label :category, "Category", class: "control-label col-md-3 col-sm-3 col-xs-12" %>
                                <div class="col-md-6 col-sm-6 col-xs-12">
                                    <%= f.text_field :category, :class => "form-control col-md-7 col-xs-12" %>
                                </div>
                            </div>
                            <div class="form-group">
                                <%= f.label :posted, "Post it?", class: "control-label col-md-3 col-sm-3 col-xs-12" %>
                                <div class="col-md-6 col-sm-6 col-xs-12">
                                    <div class="checkbox">
                                        <label class="">
                                            <div class="icheckbox_flat-green" style="position: relative;">
                                                <%= f.check_box :posted, :class => "flat" %>
                                            </div>
                                        </label>
                                    </div>
                                </div>
                            </div>
                            <div class="form-group">
                                <%= f.label :image, class: "control-label col-md-3 col-sm-3 col-xs-12" %>
                                <div class="col-md-6 col-sm-6 col-xs-12">
                                    <%= f.file_field :image, :options => {:class => "form-control col-md-7 col-xs-12", accept: "image/jpeg,image/gif,image/png"} %>
                                </div>
                            </div>
                            <div class="form-group">
                                <div class="col-md-6 col-sm-6 col-xs-12 col-md-offset-3">
                                    <%= f.submit "#{@action} Article", class: "text-center btn btn-success" %>
                                </div>
                            </div>
                            <% end %>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
    <% content_for :js do %>
    <%= javascript_include_tag "custom", "jquery", "jquery_ujs", "plugins", "functions","trumbowyg.min", "script" %>
    <script>
        $('#editor').trumbowyg();
        getText();
        $('#editor2').trumbowyg();
        getText2();
        changeLocale();
        loadArticle()
    </script>
    <% end %>
</body>
