!function(t){"use strict";function e(t,e,i){var n="",a="";if(i){var o=new Date;o.setTime(o.getTime()+60*i*1e3),n="; expires="+o.toGMTString()}m.domain&&(a="; domain="+m.domain),document.cookie=t+"="+escape(e)+n+a+"; path=/"}function i(t){var e,i,n=t+"=",a=document.cookie.split(";");for(e=0;e<a.length;e++){for(i=a[e];" "===i.charAt(0);)i=i.substring(1,i.length);if(0===i.indexOf(n))return unescape(i.substring(n.length,i.length))}return null}function n(t){e(t,"",-1)}function a(e){i("ahoy_debug")&&t.console.log(e)}function o(){for(var t;t=x.shift();)t();b=!0}function s(t){b?t():x.push(t)}function r(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(t){var e=16*Math.random()|0,i="x"==t?e:3&e|8;return i.toString(16)})}function l(){w&&e("ahoy_events",JSON.stringify(C),1)}function c(t){s(function(){w&&g.ajax({type:"POST",url:S,data:JSON.stringify([t]),contentType:"application/json; charset=utf-8",dataType:"json",success:function(){for(var e=0;e<C.length;e++)if(C[e].id==t.id){C.splice(e,1);break}l()}})})}function d(){return m.page||t.location.pathname}function h(t){var e=g(t.currentTarget);return{tag:e.get(0).tagName.toLowerCase(),id:e.attr("id"),"class":e.attr("class"),page:d(),section:e.closest("*[data-section]").data("section")}}var u,p,f,m=t.ahoy||t.Ahoy||{},g=t.jQuery||t.Zepto||t.$,v=240,y=1051200,b=!1,x=[],w="undefined"!=typeof JSON&&"undefined"!=typeof JSON.stringify,C=[],_=m.visitsUrl||"/ahoy/visits",S=m.eventsUrl||"/ahoy/events";if(u=i("ahoy_visit"),p=i("ahoy_visitor"),f=i("ahoy_track"),u&&p&&!f)a("Active visit"),o();else if(f&&n("ahoy_track"),u||(u=r(),e("ahoy_visit",u,v)),i("ahoy_visit")){a("Visit started"),p||(p=r(),e("ahoy_visitor",p,y));var T={visit_token:u,visitor_token:p,platform:m.platform||"Web",landing_page:t.location.href,screen_width:t.screen.width,screen_height:t.screen.height};document.referrer.length>0&&(T.referrer=document.referrer),a(T),g.post(_,T,o,"json")}else a("Cookies disabled"),o();m.getVisitId=m.getVisitToken=function(){return u},m.getVisitorId=m.getVisitorToken=function(){return p},m.reset=function(){return n("ahoy_visit"),n("ahoy_visitor"),n("ahoy_events"),n("ahoy_track"),!0},m.debug=function(t){return t===!1?n("ahoy_debug"):e("ahoy_debug","t",525600),!0},m.track=function(t,e){var i={id:r(),name:t,properties:e,time:(new Date).getTime()/1e3};a(i),C.push(i),l(),setTimeout(function(){c(i)},1e3)},m.trackView=function(){var e={url:t.location.href,title:document.title,page:d()};m.track("$view",e)},m.trackClicks=function(){g(document).on("click","a, button, input[type=submit]",function(t){var e=g(t.currentTarget),i=h(t);i.text="input"==i.tag?e.val():g.trim(e.text().replace(/[\s\r\n]+/g," ")),i.href=e.attr("href"),m.track("$click",i)})},m.trackSubmits=function(){g(document).on("submit","form",function(t){var e=h(t);m.track("$submit",e)})},m.trackChanges=function(){g(document).on("change","input, textarea, select",function(t){var e=h(t);m.track("$change",e)})},m.trackAll=function(){m.trackView(),m.trackClicks(),m.trackSubmits(),m.trackChanges()};try{C=JSON.parse(i("ahoy_events")||"[]")}catch(k){}for(var P=0;P<C.length;P++)c(C[P]);t.ahoy=m}(window);